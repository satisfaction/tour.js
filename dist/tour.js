!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Tour=e()}(this,function(){"use strict";function t(t,e){return function(){return t.apply(e,arguments)}}function e(t){var e,i,n,o,s,r,d;s=(new Date).getTime(),n=document.createElementNS(g,"defs"),o=document.createElementNS(g,"filter"),o.setAttributeNS(null,"id",s),o.setAttributeNS(null,"x","-50%"),o.setAttributeNS(null,"y","-50%"),o.setAttributeNS(null,"width","200%"),o.setAttributeNS(null,"height","200%"),d=document.createElementNS(g,"feOffset"),d.setAttributeNS(null,"dx",1),d.setAttributeNS(null,"dy",1),d.setAttributeNS(null,"in","SourceAlpha"),d.setAttributeNS(null,"result","ShadowOffsetOuter"),i=document.createElementNS(g,"feGaussianBlur"),i.setAttributeNS(null,"stdDeviation",2),i.setAttributeNS(null,"in","ShadowOffsetOuter"),i.setAttributeNS(null,"result","ShadowBlurOuter"),r=document.createElementNS(g,"feColorMatrix"),r.setAttributeNS(null,"values","0 0 0 0 0   0 0 0 0 0   0 0 0 0 0   0 0 0 0.3 0"),r.setAttributeNS(null,"in","ShadowBlurOuter"),r.setAttributeNS(null,"result","ShadowMatrixOuter"),e=document.createElementNS(g,"feBlend"),e.setAttributeNS(null,"in","ShadowMatrixOuter"),e.setAttributeNS(null,"in2","SourceGraphic"),e.setAttributeNS(null,"mode","normal"),o.appendChild(d),o.appendChild(i),o.appendChild(r),o.appendChild(e),n.appendChild(o),t.appendChild(n),t.setAttribute("style","filter: url(#"+s+");")}function i(t,e){var i,n,o,s,r,d;(e.previous||e.next)&&(s=document.createElement("div"),s.className="tourjs-pagination",e.next&&(n=document.createElement("a"),n.className="tourjs-next-step",n.setAttribute("href","#"),n.addEventListener("click",function(i){i.stopPropagation(),e.unload(),e.next.load(t)}),i=document.createElement("span"),i.innerText="Next",n.appendChild(i),o=l("#tutjs-chevron-ltr g"),n.appendChild(o),s.appendChild(n)),e.previous&&(r=document.createElement("a"),r.className="tourjs-previous-step",r.setAttribute("href","#"),r.addEventListener("click",function(i){i.stopPropagation(),e.unload(),e.previous.load(t)}),d=l("#tutjs-chevron-rtl g",{transform:"translate(-10)"}),r.appendChild(d),i=document.createElement("span"),i.innerText="Previous",r.appendChild(i),s.appendChild(r)),e.node.appendChild(s))}function n(t){return"tourjs-"+(t?t+"-":"")+y++}function o(t){function e(){4==i.readyState&&200==i.status&&(v=document.createElement("div"),v.innerHTML=i.responseText,t.success&&t.success())}var i=new XMLHttpRequest;i.onreadystatechange=e,i.open("GET",t.svg||"dist/tour.js.svg",!0),i.send()}function s(t){var e=t.getBoundingClientRect(),i=r();return e.right=i.width-e.right,e.bottom=i.height-e.bottom,e}function r(){var t=document.documentElement;return{width:window.innerWidth||t.clientWidth,height:window.innerHeight||t.clientHeight}}function d(){document.getElementById(m).style.display="none"}function h(t){var e={};switch(t){case"top-left":e.transform="translate(11 -12) rotate(45)";break;case"top":e.transform="translate(32) rotate(90)";break;case"top-right":e.transform="translate(60 12) rotate(135)";break;case"right":e.transform="translate(63 32) rotate(180)";break;case"bottom-right":e.transform="translate(33 60) rotate(-135)";break;case"bottom":e.transform="translate(0 64) rotate(-90)";break;case"bottom-left":e.transform="translate(-11 38) rotate(-45)";break;case"left":}return l("#tutjs-arrow g",e)}function a(){var t;document.getElementById(m)||(t=document.createElement("div"),t.id=m,document.body.appendChild(t)),document.getElementById(m).style.display="block"}function l(t,i){var n,o;return i=i||{},o=v.querySelector(t).cloneNode(!0),i.transform&&o.setAttribute("transform",i.transform),n=document.createElementNS(g,"svg"),n.setAttribute("class","tourjs-shape"),e(n),n.appendChild(o),n}function u(e){return this instanceof u?(this.id=n("hint"),this.options=e||{},void(this._setPosition=t(this._setPosition,this))):new u(e)}function p(e){return this instanceof p?(this.id=n("overview"),this.options=e||{},void(this._setPosition=t(this._setPosition,this))):new p(e)}function c(t){return this instanceof c?(this.id=n("step"),this.options=t.options||{},this._initOverview(this.options.overview),this.hints=[],void t.hints.forEach(function(t){this.hints.push(new u(t))}.bind(this))):new c(t)}function f(e){return this instanceof f?(this._onKeyUp=t(this._onKeyUp,this),this._onLoad=t(this._onLoad,this),this.unload=t(this.unload,this),this.id=n(),this.options=e.options||{},void this._initSteps(e.steps)):new f(e)}var m,v,g,y;return y=0,m="tourjs-overlay",g="http://www.w3.org/2000/svg",u.prototype={load:function(t){this.node||(this.node=document.createElement("div"),this.node.id=this.id,this.node.className="tourjs-hint",this.node.classList.add("tourjs-"+this.options.position),this.node.classList.add("tourjs-"+this.options.type),this._renderTooltip(),this._renderShape(),document.getElementById(this.id)||t.appendChild(this.node),this._setPosition()),window.addEventListener("resize",this._setPosition),this.options.highlight===!0?document.querySelector(this.options.target).classList.add("tourjs-highlight"):"string"==typeof this.options.highlight&&document.querySelector(this.options.highlight).classList.add("tourjs-highlight")},unload:function(){this.options.highlight===!0?document.querySelector(this.options.target).classList.remove("tourjs-highlight"):"string"==typeof this.options.highlight&&document.querySelector(this.options.highlight).classList.remove("tourjs-highlight"),window.removeEventListener("resize",this._setPosition)},_setPosition:function(){var t=5,e=s(document.querySelector(this.options.target)),i=s(this.node);switch(console.log(this.options.position,e,i),this.options.position){case"top-left":this.node.style.top=e.top-i.height-t+"px",this.node.style.left=e.left-i.width-t+"px";break;case"top":this.node.style.top=e.top-i.height-t+"px",this.node.style.left=e.left+e.width/2-i.width/2+"px";break;case"top-right":this.node.style.top=e.top-i.height-t+"px",this.node.style.left=e.left+e.width+5+"px";break;case"right":this.node.style.top=e.height>i.height?e.top+(e.height-i.height)/2+"px":e.top-(i.height-e.height)/2+"px",this.node.style.left=e.left+e.width+t+"px";break;case"bottom-right":this.node.style.top=e.bottom+t+"px",this.node.style.left=e.left+e.width+t+"px";break;case"bottom":this.node.style.top=e.bottom+t+"px",this.node.style.left=e.left+e.width/2-i.width/2+"px";break;case"bottom-left":this.node.style.top=e.bottom+t+"px",this.node.style.left=e.left-i.width-t+"px";break;case"left":this.node.style.top=e.height>i.height?e.top+(e.height-i.height)/2+"px":e.top-(i.height-e.height)/2+"px",this.node.style.left=e.left-i.width-t+"px"}},_renderDescription:function(t){var e;this.options.description&&(e=document.createElement("div"),e.className="tourjs-description",e.innerHTML=this.options.description,t.appendChild(e))},_renderShape:function(){var t=h(this.options.position);this.node.appendChild(t)},_renderTitle:function(t){var e=document.createElement("h2");e.innerText=this.options.title,t.appendChild(e)},_renderTooltip:function(){var t=document.createElement("div");t.className="tourjs-tooltip",this._renderTitle(t),this._renderDescription(t),this.node.appendChild(t)}},p.prototype={load:function(t){var e,i;return this.node||(this.node=document.createElement("div"),this.node.id=this.id,this.node.className="tourjs-overview",i=document.createElement("h1"),i.innerText=this.options.title,this.node.appendChild(i),this.options.description&&(e=document.createElement("div"),e.innerHTML=this.options.description,this.node.appendChild(e)),document.getElementById(this.id)||t.appendChild(this.node)),window.addEventListener("resize",this._setPosition),window.setTimeout(function(){this._setPosition()}.bind(this),0),this.node},unload:function(){window.removeEventListener("resize",this._setPosition)},_setPosition:function(){var t=s(this.node);this.node.style.marginLeft=-(t.width/2)+"px",this.node.style.marginTop=-(t.height/2)+"px"}},c.prototype={load:function(t,e){var n=function(){this.node?this.node.style.display="block":(this.node=document.createElement("div"),this.node.id=this.id,this.node.className="tourjs-step",document.getElementById(this.id)||t.appendChild(this.node),i(t,this),this._loadOverview(),this.hints.forEach(function(t){t.load(this.node)}.bind(this))),e&&e(this),"function"==typeof this.options.afterLoad&&this.options.afterLoad()}.bind(this);"function"==typeof this.options.beforeLoad?this.options.beforeLoad(n):n()},unload:function(){var t=function(){this.node&&(this.node.style.display="none",this.hints.forEach(function(t){t.unload()})),"function"==typeof this.options.afterUnload&&this.options.afterUnload()}.bind(this);"function"==typeof this.options.beforeUnload?this.options.beforeUnload(t):t()},_initOverview:function(t){t&&!this.overview&&(this.overview=new p(t))},_loadOverview:function(){this.overview&&this.node.appendChild(this.overview.load(this.node))}},f.prototype={load:function(){a();var t=function(){this.node||(this.node=document.createElement("div"),this.node.id=this.id,this.node.className="tourjs",document.getElementById(this.id)||document.body.appendChild(this.node)),o({svg:this.options.svg,success:this._onLoad}),"function"==typeof this.options.afterLoad&&this.options.afterLoad()}.bind(this);"function"==typeof this.options.beforeLoad?this.options.beforeLoad(t):t()},unload:function(){var t=function(){document.removeEventListener("keyup",this._onKeyUp),this.steps.forEach(function(t){t.unload()}),d(),"function"==typeof this.options.afterUnload&&this.options.afterUnload()}.bind(this);"function"==typeof this.options.beforeUnload?this.options.beforeUnload(t):t()},_initStep:function(){var t,e;return function(i){e=new c(i),t&&(e.previous=t,t.next=e),t=e,this.steps.push(e)}.bind(this)},_initSteps:function(t){t&&(this.steps=[],t.forEach(this._initStep()))},_onKeyUp:function(t){27===t.keyCode&&this.unload()},_onLoad:function(){document.addEventListener("keyup",this._onKeyUp),this._loadFirstStep(),"function"==typeof this.options.afterLoad&&this.options.afterLoad()},_loadFirstStep:function(){this._loadStep(0)},_loadStep:function(t){var e=this.steps[t];e.load(this.node)}},f});